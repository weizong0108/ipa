# Flutter-iOS打包流程图

## 整体打包流程

```
+-------------------------+     +-------------------------+     +-------------------------+
|                         |     |                         |     |                         |
|  1. 项目准备与检查      |---->|  2. Flutter构建阶段     |---->|  3. iOS构建与归档       |
|                         |     |                         |     |                         |
+-------------------------+     +-------------------------+     +-------------------------+
                                                                           |
                                                                           |
                                                                           v
+-------------------------+     +-------------------------+     +-------------------------+
|                         |     |                         |     |                         |
|  6. 安装与测试         |<----|  5. 分发IPA包          |<----|  4. 导出IPA包          |
|                         |     |                         |     |                         |
+-------------------------+     +-------------------------+     +-------------------------+
```

## 1. 项目准备与检查

```
+-------------------------+
| 项目准备与检查          |
+-------------------------+
| - 检查Flutter环境       |
| - 检查Xcode版本         |
| - 验证项目结构          |
| - 更新依赖              |
| - 检查证书与配置文件    |
+-------------------------+
         |
         v
+-------------------------+
| 运行项目检查脚本        |
| ./flutter_project_check.sh |
+-------------------------+
```

## 2. Flutter构建阶段

```
+-------------------------+
| Flutter构建阶段         |
+-------------------------+
| - 清理项目              |
|   flutter clean         |
| - 获取依赖              |
|   flutter pub get       |
| - 构建iOS应用           |
|   flutter build ios     |
+-------------------------+
```

## 3. iOS构建与归档

```
+-------------------------+
| iOS构建与归档           |
+-------------------------+
| - 进入iOS目录           |
|   cd ios                |
| - 安装Pod依赖           |
|   pod install           |
| - 清理Xcode项目         |
|   xcodebuild clean      |
| - 创建归档文件          |
|   xcodebuild archive    |
+-------------------------+
```

## 4. 导出IPA包

```
+-------------------------+
| 导出IPA包               |
+-------------------------+
| - 创建导出选项文件      |
|   exportOptions.plist   |
| - 从归档导出IPA         |
|   xcodebuild -exportArchive |
+-------------------------+
         |
         v
+-------------------------+
| IPA文件                 |
| ./build/IPA/应用名称.ipa |
+-------------------------+
```

## 5. 分发IPA包

```
+-----------------------------+
| 分发方式                    |
+-----------------------------+
|                             |
| +-------------------------+ |
| | App Store/TestFlight    | |
| | - 上传到App Store Connect | |
| | - 添加测试人员          | |
| +-------------------------+ |
|                             |
| +-------------------------+ |
| | Ad-hoc分发              | |
| | - 通过邮件或网站分享    | |
| | - 使用第三方分发平台    | |
| +-------------------------+ |
|                             |
| +-------------------------+ |
| | 企业分发                | |
| | - 内部服务器托管        | |
| | - MDM系统部署           | |
| +-------------------------+ |
|                             |
+-----------------------------+
```

## 使用打包脚本自动化流程

```
+--------------------------------------+
| 打包脚本使用流程                     |
+--------------------------------------+
| 1. 确保脚本有执行权限                |
|    chmod +x flutter_ios_build_ipa.sh |
|                                      |
| 2. 运行脚本(基本用法)                |
|    ./flutter_ios_build_ipa.sh --team YOUR_TEAM_ID |
|                                      |
| 3. 高级选项                          |
|    --method: 设置导出方法            |
|    --flutter-mode: 设置构建模式      |
|    --clean: 执行前清理项目           |
+--------------------------------------+
```

## 常见错误及解决流程

```
+-------------------------+     +-------------------------+     +-------------------------+
|                         |     |                         |     |                         |
|  构建失败              |---->|  查看错误日志          |---->|  参考故障排除指南      |
|                         |     |                         |     |                         |
+-------------------------+     +-------------------------+     +-------------------------+
                                                                           |
                                                                           |
                                                                           v
+-------------------------+     +-------------------------+     +-------------------------+
|                         |     |                         |     |                         |
|  问题解决              |<----|  应用解决方案          |<----|  定位问题根源          |
|                         |     |                         |     |                         |
+-------------------------+     +-------------------------+     +-------------------------+
```